import type { NextPage } from 'next';
import Head from 'next/head';
import Link from 'next/link';
import styles from '../styles/Home.module.css';
import { Layout } from '../components/layout/Layout';
import { NavBar } from '../components/layout/NavBar';
import { Login } from '../components/user/Login';
import { CategoriesNav } from '../components/CategoriesNav';
import { MenuListItem } from '../components/MenuListItem';

type Props = any;

const Menu: NextPage = ({ categories, menu }: any) => (

    <div className={styles.container}>
      <Head>
        <title>Menu</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Layout
        title="Veitingarstaðurinn Góði"
        header={(<NavBar cartItems={0}/>)}
        footer={(
          <Login />
        )}
      >
        <main>

            <ul className={styles.catNav}>
            {categories.items.map((item: any, i:number) => (
              <CategoriesNav key={i} category={item} />
            ))}
            </ul>

            <ul className={styles.menuList}>
              {menu.items.map((item: any, i:number) => (
                <MenuListItem key={i} item={item}/>
              ))}
            </ul>
        </main>
      </Layout>
    </div>
);
export async function getServerSideProps() {
  const categoriesRes = await fetch('https://vef2-2022-h1-synilausn.herokuapp.com/categories');
  const categories = await categoriesRes.json();
  const menuRes = await fetch('https://vef2-2022-h1-synilausn.herokuapp.com/menu');
  const menu = await menuRes.json();
  return { props: { categories, menu } };
}

export default Menu;
